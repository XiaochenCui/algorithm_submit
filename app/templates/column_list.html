{% extends "base.html" %}

{% block title %}{{ super() }}栏目列表{% endblock %}

{% block page_content %}
<div class="entry-tabs">
    <ul class="nav nav-tabs">
        <li><a href="#">所有栏目</a></li>
    </ul>
</div>
<strong>Enter a value to echo back:</strong>
<input size="10" id="echoText" name="echoText" type="text">
<button type="button" id="submitBtn" name="submitBtn">Submit via AJAX</button><br><br>
<strong>
    <div id="echoResult"></div>
</strong>
<ul class="entries">
    {% for column in columns %}
    <li class="entry">
        <div class="entry-content">
            <div class="entry-body">
                        <span class="normal">
                            {{ column.title }}
                            <button>更改</button>
                        </span>
                <span class="edit">
                <form action="{{ url_for('main.column_title') }}" method="post" class="form-inline">
                    {{ form.hidden_tag() }}
                    {{ form.title() }}
                    {{ form.id(hidden="hidden", value=column.id) }}
                    {{ form.submit() }}
                </form>
                    </span>
            </div>
            <div class="entry-footer">
                <a href="{{ url_for('.article_list', id=column.id) }}">
                    <span class="label label-primary">文章列表</span>
                </a>
                <a rel="edit" href="javascript:void(0)">
                    <span class="label label-info">编辑</span>
                </a>
                <a rel="update" href="javascript:void(0)">
                    <span class="label label-info">更新</span>
                </a>
                <a rel="cancel" href="javascript:void(0)">
                    <span class="label label-info">取消</span>
                </a>
                <a href="{{ url_for('.column_delete', id=column.id) }}">
                    <span class="label label-warning">删除</span>
                </a>
            </div>
        </div>
    </li>
    {% endfor %}
</ul>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
    $(function () {
        $("#submitBtn").click(function () {
            $.ajax({
                type: "GET",
                url: "/echo/",
                contentType: "application/json; charset=utf-8",
                data: {echoValue: $('input[name="echoText"]').val()},
                success: function (data) {
                    $('#echoResult').text(data.value);
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    alert(errorThrown);
                }
            });
        });
    });
    $(document).ready(function () {
        $(".edit").hide();
        $(".normal button").click(function () {
            $(this).parent().siblings(".edit").toggle();
            $(this).parent().toggle();
        });
        $(".edit button").click(function () {
            $(this).parent().toggle();
            $(this).parent().siblings(".edit").toggle();
        });
    });
</script>
{% endblock %}